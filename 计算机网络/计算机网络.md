# DNS服务器

- 安装DNS服务器

  - 区域名：gduf.com

  - 成功创建了gduf.com区域之后，此时用户不能应这个名称来访问内部站点，因为还不是一个合格的域名，还需要创建指向不同主机的域名才能提供域名解析服务。

  - gduf.com只是一个区域名，需要加上不同的主机，才是构成一个完整的域名服务。

  - 客户端设置的IP，子网需要和DNS静态服务器的ip一样，然后首选的DNS服务器地址，需要和前面DNS设置的静态ip地址一样

  - 设置正向查找和反向查找，可以添加不同的主机(例如：test)，www和ftp只是主机的别名

  - 最后ping的是www.gduf.com(gduf.com是区域名)，==一个DNS名称表示为主机名+DNS域名==

  - 动态DNS更新，计算机c的ip是由DHCP服务器动态分配的，DHCP和DNS服务器是在集成在同一台计算机上，计算机A（DHCP)服务器需要加入到gduf.com域中（需要修改计算机名，test.gduf.com,这里可以取个别名www，替代主机名),计算机c也需要更改计算机名称，syzx70807.gduf.com(域名需要相同)，两者换完名称之后都需要重新启动计算器。

  - 计算机c是采用自动获取ip的方式，，向DHCP服务器申请ip地址，由于DHCP服务器的静态ip地址是192.168.0.1,根据按序分配的规则，此时计算机C的ip地址为192.168.0.2,可以在DHCP服务器的地址租约可以看到，返回到DNS服务器中，可以看到计算机c的主机名和对应的ip已经自动加入到了正向查找区域，可以在计算机c上面ping   syzx70807.gduf.com看是否可以ping通。

  - 实验结果：是可以ping通的

  - 一个DNS名称表示为主机名+DNS域名，这个定义是所有操作的关键，在安装DNs服务器的时候，首先定义好区域名，然后在DNS服务中加入不同的主机名，通过正向查找和反向查找，可以让ip地址和域名以一一对应，DNS服务器创建之后，就可以在客户端上面设置ip地址（与添加的主机是一样的ip）以及和DNS服务器一样的ip，在客户端中ping一下www.gduf.com可以ping通，然后使用nslookup可以查看到ip地址以及对应的主机名称，动态DNS更新，需要DHCP服务器分配ip地址给计算机c，DHCP服务器和DNS服务器是集成在一台计算机上面的，需要让DHCP服务器和计算机c在同一个域中，也就是需要修改名字，修改重启之后，可以看到DHCP服务器有了一个新增的ip,在DNS服务器中也可以看到名称和对应的IP

    

# 路由器配置

实验设备：计算机C（2003操作系统），完成路由器的功能

- 计算机A1和计算机A2的默认网关需要和计算机C中连接子网A的ip相同

- 计算机B的默认网关需要和计算机C连接子网B的ip相同

  

==疑问==

1.计算机C是既当服务器（√），又当路由器吗（√）

NAT配置

将路由器转化为NAT服务器，可以将多个内部ip地址映射成单个全局ip地址

思考题：计算机B能否ping通子网A内计算机

> 不能，因为没有使用到本地连接A，不能将B中的映射到A中（个 人猜测）

路由器相关知识：

- 路由器只根据ip地址来转发数据

- 静态路由：人工配置的（目标网络和要转发的接口地址）

- 默认静态路由：当想要访问因特网上面的网络时（因为因特网上面的网络太多了），所以不可以将所有的网络都放在路由表上面，只能是设置默默人静态路由，设置的目标网络为0.0.0.0，当在路由表上面找不到网络的时候，就会找到默认路由，然后跳转到相应的接口

- 特定主机路由：目标网络设置为主机的ip，在路由表从查询的时候，会按照最长前缀优先选择特定主机路由（而不是默认路由）

  ![](C:\Users\马镇涛\Searches\Pictures\静态路由.png)

Ip数据报的转发

问题：源主机如如何判断目的主机是否与自己在同一个网络中

![](C:\Users\马镇涛\Searches\Pictures\ip数据报的转发.png)

==举例说明==

假设主机传送数据报给主机F，主机c的ip地址与子网掩码相与就可以得出主机c所在的网络的ip地址192.168.0.0。主机F的ip地址与主机C的子网掩码相与就可以得出目的网络地址（192.168.0.128），目的网络地址和主机C所在的网络地址不相同，所以不在同一个网络中，主机C与主机F之间的通信属于间接交付。

主机C需要先将数据报转发给路由器，然后再有路由器转发给主机F，问题：主机C怎么直接到将数据报转发给哪个路由器。

<font color="red">每个网络中的主机会有属于自己的一个路由器，也就是默认网关，主机A,B,C的默认网关都是192.168.0.126（也就是路由器的接口0）</font>

在本例中，主机C会将ip数据报转发给默认网关，也就是接口0，那么当路由器接受到ip数据报后是如何转发的呢

![](C:\Users\马镇涛\Searches\Pictures\路由器转发数据报.png)

后续的详情看湖科大教书匠ip数据的转发过程（P48）